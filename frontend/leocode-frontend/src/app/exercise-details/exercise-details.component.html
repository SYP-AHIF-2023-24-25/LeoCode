<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="#">LeoCode</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
    <ul class="navbar-nav">
      <li class="nav-item">
        <span class="navbar-text text-light">
          {{ ifUserName }}
        </span>
      </li>
      <li class="nav-item">
        <button class="btn btn-outline-light ml-3" (click)="logout()">Logout</button>
      </li>
    </ul>
  </div>
</nav>

<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-md-10">
      <div class="card mt-3">
        <div class="card-body d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center">
            <h2 *ngIf="!isEditingName" class="display-4">{{ exercise.name }}</h2>
            <input *ngIf="isEditingName" type="text" class="form-control mr-2" [(ngModel)]="exercise.name">
            <button *ngIf="ifUserName == exercise.creator && !isEditingName" class="btn" (click)="editExerciseName()" style="background: none; border: none; padding: 0;">
              <mat-icon style="color: gray;">edit</mat-icon>
            </button>
          </div>

          <div class="text-right">
            <p class="mb-1" style="font-size: 16px;">Created on: {{ exercise.dateCreated | date: 'mediumDate' }}</p>
            <p class="mb-0" style="font-size: 18px;">Creator: {{ exercise.creator }}</p>
          </div>
        </div>

        <div class="card-body">
          <div *ngIf="ifUserName == exercise.creator">

            <!-- Ausgewählte Tags anzeigen -->
            <form *ngIf="ifUserName == exercise.creator">
              <mat-form-field class="example-chip-list" style="width: 100%">
                <mat-label>Chosen Tags</mat-label>
                <mat-chip-grid #chipGrid aria-label="Tag selection">
                  <mat-chip-row *ngFor="let tag of exercise.tags" (removed)="removeTag(tag)">
                    {{ tag }}
                    <button matChipRemove [attr.aria-label]="'remove ' + tag">
                      <mat-icon>cancel</mat-icon>
                    </button>
                  </mat-chip-row>
                </mat-chip-grid>
                <input placeholder="New Tag..." #tagInput [formControl]="tagCtrl"
                  [matChipInputFor]="chipGrid" [matAutocomplete]="auto"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  (matChipInputTokenEnd)="addTag($event)" />
                <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event)">
                  <mat-option *ngFor="let tag of filteredTags | async" [value]="tag">
                    {{ tag }}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>
            </form>
          </div>

          <!-- Tags für nicht-Creator anzeigen -->
          <div *ngIf="ifUserName != exercise.creator">
            <h1>Tags</h1>
            <ul>
              <li *ngFor="let tag of exercise.tags">
                {{ tag }}
              </li>
            </ul>
          </div>

            <h1 class="d-flex align-items-center">
              Introduction
              <button *ngIf="!isEditingDescription" class="btn" (click)="editDescription()" style="background: none; border: none; padding: 0;">
                <mat-icon style="color: gray;">edit</mat-icon>
              </button>
            </h1>

            <div class="form-group">
              <textarea *ngIf="isEditingDescription" class="form-control" rows="5" style="width: 100%" [(ngModel)]="exercise.description"></textarea>
              <p *ngIf="!isEditingDescription" class="card-text" style="white-space: pre-wrap;">{{ exercise.description }}</p>
            </div>

            <div class="row justify-content-center">
              <div class="col-md-12">
                <div class="card mt-5">
                    <div class="drag-drop-area" 
                        (drop)="uploadZipFile($event); $event.preventDefault();" 
                        (dragover)="$event.preventDefault();">
                      <p *ngIf="!zipFile">Drag & Drop your file here</p>
                      <button class="btn-ZipFile" *ngIf="zipFile" (click)="clearZipFile()" >
                        <p>{{zipFile.name}} <mat-icon>cancel</mat-icon></p>
                      </button>             
                    </div>
       
                    <br><br>
                    <p>Upload template solution:</p>
                    <div class="drag-drop-area" 
                        (drop)="uploadEmptyZipFile($event); $event.preventDefault();" 
                        (dragover)="$event.preventDefault();">
                      <p *ngIf="!emptyZipFile">Drag & Drop your file here</p>
                      <button class="btn-ZipFile" *ngIf="emptyZipFile" (click)="clearEmptyZipFile()">
                        <p>{{emptyZipFile.name}} <mat-icon>cancel</mat-icon></p>
                      </button>
                    </div>
                  </div>
                </div>


          <div class="d-flex">
            <button class="btn btn-primary" [routerLink]="['/test-results']" [queryParams]="{ exerciseName: exercise.name, creator: exercise.creator }">Run Test</button>
            <button *ngIf="ifUserName == exercise.creator" class="btn btn-primary ml-2" (click)="SaveChanges()">Save Changes</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
